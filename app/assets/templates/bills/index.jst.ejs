<a href="#bills/new">New Bill</a>

<h3>All bills</h3>

<table>
	<tr>
		<th>Who Paid</th>
		<th>Description</th>
		<th>Bill Total</th>
		<th>Amt Owed</th>
	</tr>

	<% bills.each(function(bill) { %>
		<% var payer_id = bill.escape('user_id'); %>
		<% var payer = connections.get(payer_id); %>
		<% var payer_email = (payer ? payer.escape('email') : 'Me') %>

		<% var share = parseFloat(bill.escape('amount') / (bill.get('billings').length + 1)).toFixed(2) %>

		<% if (payer_email === 'Me') { %>
			<% var share = (share - parseFloat(bill.escape('amount'))).toFixed(2) %>
		<% }; %>

		<tr>
			<td><%= payer_email %></td>
			<td><%= bill.escape('description') %></td>
			<td>$ <%= parseFloat(bill.escape('amount')).toFixed(2) %></td>
			<td>$ <%= share %></td>
		</tr>
	<% }); %>
</table>